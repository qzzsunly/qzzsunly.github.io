<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>47.&nbsp;Monitoring and management over HTTP</title><link rel="stylesheet" type="text/css" href="css/manual-multipage.css"><meta name="generator" content="DocBook XSL Stylesheets V1.78.1"><link rel="home" href="index.html" title="Spring Boot Reference Guide"><link rel="up" href="production-ready.html" title="Part&nbsp;V.&nbsp;Spring Boot Actuator: Production-ready features"><link rel="prev" href="production-ready-endpoints.html" title="46.&nbsp;Endpoints"><link rel="next" href="production-ready-jmx.html" title="48.&nbsp;Monitoring and management over JMX"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">47.&nbsp;Monitoring and management over HTTP</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="production-ready-endpoints.html">Prev</a>&nbsp;</td><th width="60%" align="center">Part&nbsp;V.&nbsp;Spring Boot Actuator: Production-ready features</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="production-ready-jmx.html">Next</a></td></tr></table><hr></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a name="production-ready-monitoring" href="#production-ready-monitoring"></a>47.&nbsp;Monitoring and management over HTTP</h2></div></div></div><p>If you are developing a Spring MVC application, Spring Boot Actuator will auto-configure
all enabled endpoints to be exposed over HTTP. The default convention is to use the
<code class="literal">id</code> of the endpoint as the URL path. For example, <code class="literal">health</code> is exposed as <code class="literal">/health</code>.</p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="production-ready-sensitive-endpoints" href="#production-ready-sensitive-endpoints"></a>47.1&nbsp;Securing sensitive endpoints</h2></div></div></div><p>If you add &#8216;Spring Security&#8217; to your project, all sensitive endpoints exposed over HTTP
will be protected. By default &#8216;basic&#8217; authentication will be used with the username
<code class="literal">user</code> and a generated password (which is printed on the console when the application
starts).</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Tip"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Tip]" src="images/tip.png"></td><th align="left">Tip</th></tr><tr><td align="left" valign="top"><p>Generated passwords are logged as the application starts. Search for &#8216;Using default
security password&#8217;.</p></td></tr></table></div><p>You can use Spring properties to change the username and password and to change the
security role(s) required to access the endpoints. For example, you might set the following
in your <code class="literal">application.properties</code>:</p><pre class="programlisting"><span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">security.user.name</span>=admin
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">security.user.password</span>=secret
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">management.security.roles</span>=SUPERUSER</pre><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Tip"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Tip]" src="images/tip.png"></td><th align="left">Tip</th></tr><tr><td align="left" valign="top"><p>If you don&#8217;t use Spring Security and your HTTP endpoints are exposed publicly,
you should carefully consider which endpoints you enable. See
<a class="xref" href="production-ready-endpoints.html#production-ready-customizing-endpoints" title="46.1&nbsp;Customizing endpoints">Section&nbsp;46.1, &#8220;Customizing endpoints&#8221;</a> for details of how you can set
<code class="literal">endpoints.enabled</code> to <code class="literal">false</code> then &#8220;opt-in&#8221; only specific endpoints.</p></td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="production-ready-customizing-management-server-context-path" href="#production-ready-customizing-management-server-context-path"></a>47.2&nbsp;Customizing the management endpoint paths</h2></div></div></div><p>Sometimes it is useful to group all management endpoints under a single path. For example,
your application might already use <code class="literal">/info</code> for another purpose. You can use the
<code class="literal">management.context-path</code> property to set a prefix for your management endpoint:</p><pre class="programlisting"><span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">management.context-path</span>=/manage</pre><p>The <code class="literal">application.properties</code> example above will change the endpoint from <code class="literal">/{id}</code> to
<code class="literal">/manage/{id}</code> (e.g. <code class="literal">/manage/info</code>).</p><p>You can also change the &#8220;id&#8221; of an endpoint (using <code class="literal">endpoints.{name}.id</code>) which then
changes the default resource path for the MVC endpoint. Legal endpoint ids are composed
only of alphanumeric characters (because they can be exposed in a number of places,
including JMX object names, where special characters are forbidden). The MVC path can be
changed separately by configuring <code class="literal">endpoints.{name}.path</code>, and there is no validation on
those values (so you can use anything that is legal in a URL path). For example, to change
the location of the <code class="literal">/health</code> endpoint to <code class="literal">/ping/me</code> you can set
<code class="literal">endpoints.health.path=/ping/me</code>.</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Tip"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Tip]" src="images/tip.png"></td><th align="left">Tip</th></tr><tr><td align="left" valign="top"><p>If you provide a custom <code class="literal">MvcEndpoint</code> remember to include a settable <code class="literal">path</code> property,
and default it to <code class="literal">/{id}</code> if you want your code to behave like the standard MVC endpoints.
(Take a look at the <code class="literal">HealthMvcEndpoint</code> to see how you might do that.) If your custom
endpoint is an <code class="literal">Endpoint</code> (not an <code class="literal">MvcEndpoint</code>) then Spring Boot will take care of the
path for you.</p></td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="production-ready-customizing-management-server-port" href="#production-ready-customizing-management-server-port"></a>47.3&nbsp;Customizing the management server port</h2></div></div></div><p>Exposing management endpoints using the default HTTP port is a sensible choice for cloud
based deployments. If, however, your application runs inside your own data center you
may prefer to expose endpoints using a different HTTP port.</p><p>The <code class="literal">management.port</code> property can be used to change the HTTP port.</p><pre class="programlisting"><span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">management.port</span>=8081</pre><p>Since your management port is often protected by a firewall, and not exposed to the public
you might not need security on the management endpoints, even if your main application is
secure. In that case you will have Spring Security on the classpath, and you can disable
management security like this:</p><pre class="programlisting"><span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">management.security.enabled</span>=false</pre><p>(If you don&#8217;t have Spring Security on the classpath then there is no need to explicitly
disable the management security in this way, and it might even break the application.)</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="production-ready-management-specific-ssl" href="#production-ready-management-specific-ssl"></a>47.4&nbsp;Configuring management-specific SSL</h2></div></div></div><p>When configured to use a custom port, the management server can also be configured with
its own SSL using the various <code class="literal">management.ssl.*</code> properties. For example, this allows a
management server to be available via HTTP while the main application uses HTTPS:</p><pre class="programlisting"><span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">server.port</span>=8443
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">server.ssl.enabled</span>=true
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">server.ssl.key-store</span>=classpath:store.jks
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">server.ssl.key-password</span>=secret
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">management.port</span>=8080
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">management.ssl.enable</span>=false</pre><p>Alternatively, both the main server and the management server can use SSL but with
different key stores:</p><pre class="programlisting"><span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">server.port</span>=8443
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">server.ssl.enabled</span>=true
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">server.ssl.key-store</span>=classpath:main.jks
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">server.ssl.key-password</span>=secret
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">management.port</span>=8080
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">management.ssl.enable</span>=true
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">management.ssl.key-store</span>=classpath:management.jks
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">management.ssl.key-password</span>=secret</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="production-ready-customizing-management-server-address" href="#production-ready-customizing-management-server-address"></a>47.5&nbsp;Customizing the management server address</h2></div></div></div><p>You can customize the address that the management endpoints are available on by
setting the <code class="literal">management.address</code> property. This can be useful if you want to
listen only on an internal or ops-facing network, or to only listen for connections from
<code class="literal">localhost</code>.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="images/note.png"></td><th align="left">Note</th></tr><tr><td align="left" valign="top"><p>You can only listen on a different address if the port is different to the
main server port.</p></td></tr></table></div><p>Here is an example <code class="literal">application.properties</code> that will not allow remote management
connections:</p><pre class="programlisting"><span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">management.port</span>=8081
<span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">management.address</span>=127.0.0.1</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="production-ready-disabling-http-endpoints" href="#production-ready-disabling-http-endpoints"></a>47.6&nbsp;Disabling HTTP endpoints</h2></div></div></div><p>If you don&#8217;t want to expose endpoints over HTTP you can set the management port to <code class="literal">-1</code>:</p><pre class="programlisting"><span xmlns:d="http://docbook.org/ns/docbook" class="hl-attribute">management.port</span>=-1</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="production-ready-health-access-restrictions" href="#production-ready-health-access-restrictions"></a>47.7&nbsp;HTTP health endpoint access restrictions</h2></div></div></div><p>The information exposed by the health endpoint varies depending on whether or not it&#8217;s
accessed anonymously, and whether or not the enclosing application is secure.
By default, when accessed anonymously in a secure application, any details about the
server&#8217;s health are hidden and the endpoint will simply indicate whether or not the server
is up or down. Furthermore the response is cached for a configurable period to prevent the
endpoint being used in a denial of service attack. The <code class="literal">endpoints.health.time-to-live</code>
property is used to configure the caching period in milliseconds. It defaults to 1000,
i.e. one second.</p><p>The above-described restrictions can be enhanced, thereby allowing only authenticated
users full access to the health endpoint in a secure application. To do so, set
<code class="literal">endpoints.health.sensitive</code> to <code class="literal">true</code>. Here&#8217;s a summary of behavior (with default
<code class="literal">sensitive</code> flag value &#8220;false&#8221; indicated in bold):</p><div class="informaltable"><table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col class="col_1"><col class="col_2"><col class="col_3"><col class="col_4"></colgroup><thead><tr><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><code class="literal">management.security.enabled</code></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><code class="literal">endpoints.health.sensitive</code></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">Unauthenticated</th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top">Authenticated</th></tr></thead><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>false</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><span class="strong"><strong>false</strong></span></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Full content</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Full content</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>false</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>true</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Status only</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Full content</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>true</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p><span class="strong"><strong>false</strong></span></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Status only</p></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><p>Full content</p></td></tr><tr><td style="border-right: 0.5pt solid ; " align="left" valign="top"><p>true</p></td><td style="border-right: 0.5pt solid ; " align="left" valign="top"><p>true</p></td><td style="border-right: 0.5pt solid ; " align="left" valign="top"><p>No content</p></td><td style="" align="left" valign="top"><p>Full content</p></td></tr></tbody></table></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="production-ready-endpoints.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="production-ready.html">Up</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="production-ready-jmx.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">46.&nbsp;Endpoints&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;48.&nbsp;Monitoring and management over JMX</td></tr></table></div></body></html>